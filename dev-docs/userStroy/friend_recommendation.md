# User Story: 智能话题匹配与好友推荐 (Smart Topic Matching & Friend Recommendation)

## 1. 背景与目标 (Background & Goals)
在 WeAgentChat 中，用户有时会有明确的聊天**话题**（如“火箭科学”、“感情困扰”、“科幻小说”），但不知道该找哪位 AI 好友讨论最合适。

当前流程是用户必须先明确“我要找谁”，然后去创建或寻找这个人。
本功能旨在颠覆这一流程，实现 **“话题 -> 推荐人选 -> 自动生成好友”** 的闭环。用户只需输入话题，系统智能推荐适合的名人或专家。

**注意**：本功能专注于**创造**。无论推荐的角色是否在我们的“预设好友库”中存在，我们都将其视为一个新的创作灵感。用户可以基于推荐，从头生成一个属于自己的通用版或魔改版角色，而不强制关联到官方预设。

---

## 2. 用户故事 (User Stories)

### US-1: 基于话题的智能推荐
**作为** 用户，
**我希望** 在“AI 伙伴创建向导”中，可以选择“通过话题寻找伙伴”模式，输入一个感兴趣的话题（例如“想聊聊三体”），
**以便于** 系统能智能联想并推荐 3-5 位适合该话题的历史名人、领域专家或虚构角色（例如“刘慈欣”、“叶文洁”、“雷兹星”）。

### US-2: 推荐结果到角色生成的无缝衔接
**作为** 用户，
**我希望** 当我点击任意一个推荐人物卡片时，
**以便于** 系统自动跳转到设定生成界面，并**自动填充**该人物的名字和背景描述（基于推荐理由扩展），我只需点击生成按钮，即可快速创建这位 AI 好友。

---

## 3. 功能流程与交互 (Workflow & Interaction)

1.  **入口优化**：改造 `AssistantWizard.vue` 的初始状态。
    *   **Tab 1：自定义创建**（默认）：直接输入名字和描述。
    *   **Tab 2：话题找人**（新功能）：输入话题，点击“寻找伙伴”。
2.  **推荐与展示**：
    *   用户输入话题（如“量子力学”）后，显示推荐卡片列表。
    *   卡片显示：姓名、推荐理由、职业/身份标签。
3.  **生成流程**：
    *   用户点击其中一张卡片（如“理查德·费曼”）。
    *   界面自动切回 **Tab 1**。
    *   名字输入框自动填入：“理查德·费曼”。
    *   描述输入框自动填入系统生成的背景提示（例如：“一位风趣幽默的物理学家，擅长用通俗易懂的语言解释复杂的概念...”）。
    *   用户可在此基础上修改，或直接点击“开始生成”进入 System Prompt 生成阶段。

---

## 4. 技术实现路线 (Implementation Roadmap)

### 4.1 后端 (Backend)
*   **Prompt 设计**：新增 `friend_recommendation.yaml` prompt。
    *   Input: 用户话题。
    *   Output: JSON 列表，包含 `name` (名字), `reason` (推荐理由), `description_hint` (背景描述建议)。
*   **API 接口**：新增 endpoint `POST /api/friends/recommend`。
    *   接收 `topic` 字符串，返回推荐列表。
    *   **无需**查询本地数据库进行去重或匹配，保持纯粹的推荐逻辑。

### 4.2 前端 (Frontend)
*   **组件改造**：`AssistantWizard.vue`。
    *   增加顶部 Tabs (shadcn `Tabs` 组件) 切换“自定义”和“话题推荐”模式。
    *   实现“话题推荐”视图：包含话题输入框、加载状态、卡片列表。
    *   实现数据回填逻辑：点击卡片 -> `model.name = item.name` -> `model.description = item.description_hint` -> Switch Tab。
    *   (可选) 视觉优化：给推荐卡片添加随机的渐变色或图标，避免视觉单调。

---

## 5. 验收标准 (Acceptance Criteria)

- [ ] **AC-1**: 入口切换流畅，在 Wizard 内能方便地在手动输入和话题查找间切换。
- [ ] **AC-2**: 推荐结果准确性：输入特定领域话题能推荐对口的专家或角色。
- [ ] **AC-3**: 自动填充体验：点击推荐后，所有必要信息都被填入表单，用户可以直接进行下一步。
- [ ] **AC-4**: 独立性：即使推荐了“苏格拉底”（预设库已有），点击后依然是创建一个新的、用户私有的“苏格拉底”，而不是跳转到预设库。
