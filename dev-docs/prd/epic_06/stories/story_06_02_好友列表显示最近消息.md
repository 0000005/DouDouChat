# Story 06-02: 好友列表显示最近消息

> Epic: 好友列表与聊天标题优化
> Priority: High
> Points: 5

## 概述

优化好友列表的信息展示方式，将好友名称下方的内容从静态的 `description` 改为动态的"最近一条消息预览"。这符合微信等主流社交应用的交互模式，帮助用户快速了解与每个好友的对话状态。

## 用户故事

### US-1: 查看最近对话内容
**作为** 用户，
**我希望** 在好友列表中看到每个好友的最近一条消息，
**以便** 我能快速回忆与该好友的对话状态，决定是否继续聊天。

### US-2: 消息预览格式
**作为** 用户，
**我希望** 消息预览简洁明了，过长时自动截断，
**以便** 列表保持整洁，不会因为长消息而影响阅读体验。

## 功能范围

### 包含
- 后端 API：新增获取好友最近消息的接口或扩展现有好友列表接口
- 前端 Store：扩展好友数据结构，缓存最近消息信息
- 前端 UI：修改 `Sidebar.vue`，将预览区域从 `description` 改为最近消息
- 消息预览：过长消息自动截断并显示省略号

### 不包含（后续迭代）
- 消息搜索功能
- 未读消息计数显示
- 消息预览中的多媒体内容展示（图片、表情等）

## 验收标准

- [ ] AC-1: 好友列表中每个好友名称下方显示最近一条消息的内容预览
- [ ] AC-2: 若无消息记录，显示好友的 `description` 作为回退
- [ ] AC-3: 消息预览超过一定长度（如30字符）时截断并显示 "..."
- [ ] AC-4: 消息来源区分用户和助手角色，用户消息前可加 "[我]" 前缀
- [ ] AC-5: 列表按最后消息时间倒序排列（最新对话的好友在上方）
- [ ] AC-6: 发送新消息后，好友列表实时更新预览内容

## 依赖关系

### 前置依赖
- Story 06-01: 默认招呼消息（确保新好友有消息可展示）

### 被依赖（后续）
- 无直接依赖

## 备注

- 性能考虑：最近消息应在查询好友列表时一并返回，避免 N+1 查询
- 现有排序逻辑：好友列表当前按 `pinned_at`（置顶）和 `update_time` 排序，需结合最后消息时间调整
- 前端应考虑消息更新时的响应式刷新机制
