# Epic 06: 好友列表与聊天标题优化

## Epic 信息
- **Epic 编号**: Epic-06
- **Epic 名称**: 好友列表与聊天标题优化
- **创建日期**: 2026-01-13
- **优先级**: High

## 业务目标

1. **提升好友列表信息价值**：当前好友列表在好友名称下方显示的是好友的描述信息，这对于用户快速了解最近对话内容并无帮助。优化后显示最近一条消息，让用户能够一目了然地知道与每个好友的对话状态，这是微信等主流社交应用的标准交互模式。

2. **优化聊天窗口标题区域的信息层次**：当前聊天窗口标题仅显示好友名称，缺少快速了解好友身份的途径。优化后将好友名称左移，并在旁边用灰色小字显示好友描述简介，帮助用户快速回忆该好友的角色定位。同时，点击好友姓名可弹出抽屉菜单，提供更便捷的好友设置入口。

3. **初始化默认招呼消息**：好友库 (`friend_templates`) 已具备 `initial_message` 字段存储默认招呼语。当用户从好友库添加好友时，需自动用该消息创建第一条聊天记录；预设好友初始化时也需创建默认消息。这样可以保证好友列表始终有内容可展示，提升用户体验的完整性。

## 范围描述

### 包含内容
- **好友列表优化**：修改 Sidebar.vue，将好友预览区域从显示 `description` 改为显示最近一条消息
- **聊天标题优化**：修改 ChatArea.vue，好友名称左移，旁边显示灰色描述简介（超出省略，hover 显示全部）
- **标题点击交互**：点击好友姓名弹出右侧好友菜单抽屉
- **默认招呼消息**：利用好友库已有的 `initial_message` 字段，在添加好友时自动创建第一条消息记录
- **预设好友初始化**：在数据库初始化时为预设好友创建默认的招呼消息记录
- **新好友默认消息**：创建好友时自动生成一条招呼消息

### 不包含内容
- 消息搜索功能
- 好友分组/标签功能
- 批量消息操作
- 消息通知提醒

## 用户旅程

```
[好友列表场景]
用户打开应用 → 查看好友列表 → 看到每个好友名称下方显示最后一条消息 
→ 快速定位想要继续聊天的好友 → 点击进入聊天

[聊天标题场景]
用户进入聊天界面 → 看到标题区域显示"好友名称 | 好友描述简介"
→ 描述过长时显示省略号 → hover 上去查看完整描述
→ 点击好友名称 → 弹出右侧好友菜单抽屉 → 快速访问好友设置

[新好友场景]
用户添加新好友 → 系统自动创建默认招呼消息 
→ 好友立即在列表中显示该招呼消息 → 用户可直接开始对话
```

## Story 拆分建议

| Story | 描述 | 优先级 |
|-------|------|--------|
| Story 06-01 | 默认招呼消息：从好友库添加好友时使用 `initial_message` 创建首条消息、预设好友初始化时创建默认消息记录 | High |
| Story 06-02 | 好友列表优化：获取好友最近一条消息的 API/Store 逻辑、列表 UI 改为显示最近消息 | High |
| Story 06-03 | 聊天标题优化：名称左移 + 描述简介（超出省略/hover全显）、点击好友名称弹出右侧菜单抽屉 | Medium |

## 技术约束

- **前端**：Vue 3 + shadcn-vue 组件库
- **后端**：FastAPI + SQLAlchemy + SQLite
- **数据库迁移**：使用 Alembic 管理 schema 变更
- **API 设计**：遵循现有 RESTful 风格，前缀 `/api`

## 依赖关系

### 前置依赖
- Epic-01: 基础聊天功能和好友管理（已完成）

### 后续 Epic
- 无直接依赖
