# Story 09-02: 群组管理服务端接口 (API)

> Epic: AI 多人群聊 (Group Chat)
> Priority: High
> Points: 5

## 概述
实现群组管理的核心后端逻辑。提供稳定、安全的 RESTful API 供前端调用，涵盖群组从创建到解散（成员退出）的全生命周期，并确保数据在 `Group` 和 `GroupMember` 表中的一致性。

## 用户故事

### US-1: 群组生命周期管理
**作为** 开发者，
**我希望** 提供一套完善的任务管理接口（创建、邀请、移除、退出），
**以便** 支撑前端的群组配置需求。

### US-2: 群配置持久化
**作为** 系统，
**我希望** 能够持久化存储群聊名称、头像、描述及自动回复开关状态，
**以便** 在用户重新登录时恢复群聊状态。

## 功能范围

### 包含
- **管理 API 实现**: 
  - `GET /api/groups`: 获取当前用户加入的所有群组（侧边栏列表展示用）。
  - `POST /api/group/create`: 提交名称和初始成员列表创建新群。
  - `POST /api/group/invite`: 向现有群组添加新成员。
  - `PATCH /api/group/settings`: 更新群名称、描述、头像或 auto_reply 开关。
  - `DELETE /api/group/exit`: 当前用户退出群组。
  - `DELETE /api/group/{id}/member/{member_id}`: 群主移除指定群成员。
  - `GET /api/group/{id}`: 获取群详情及成员列表（前端设置页展示用）。
- **权限校验**:
  - 仅群主 (owner_id) 可修改群设置或移除成员。
  - 仅群成员可获取群详情或退出群组。

### 不包含（后续迭代）
- 解散群组（本阶段仅支持个人退出）
- 群权限分级（初步仅区分群主与成员）

## 验收标准

- [ ] AC-1: 开发完成 `POST /api/group/create`，能根据提交的成员 ID 正确初始化 `Group` 和 `GroupMember` 数据。
- [ ] AC-2: `GET /api/groups` 能正确返回用户所属群组列表，包含群组基本信息。
- [ ] AC-3: 实现群主移除成员逻辑，并验证当非群主操作时返回 403 权限错误。
- [ ] AC-4: 实现“删除并退出”逻辑：用户退出后，群成员记录被逻辑删除或物理删除，且该群不再出现在用户列表。
- [ ] AC-5: `PATCH /api/group/settings` 能成功更新群名称、自动回复开关等字段。

## 依赖关系

### 前置依赖
- Story 09-01: 群聊数据建模

### 被依赖（后续）
- Story 09-03: 群组管理界面开发 (UI)
- Story 09-05: 群聊消息服务接口 (API & SSE)
