# Story 03-02: 会话列表功能

> Epic: 聊天详情抽屉菜单  
> Priority: High  
> Points: 5

## 概述
在抽屉菜单中点击"会话列表"菜单项后，展示与当前好友的所有历史会话。用户可以查看每个会话的时间范围和消息数量，并能够切换到指定的历史会话。这让用户能够轻松回顾与 AI 好友的互动历史。

## 用户故事

### US-1: 查看历史会话列表
**作为** 用户，  
**我希望** 点击"会话列表"后能够看到与当前好友的所有历史会话，  
**以便** 了解我们之前的对话记录。

### US-2: 切换到历史会话
**作为** 用户，  
**我希望** 点击某个历史会话后，聊天区域能够显示该会话的消息记录，  
**以便** 回顾特定时间段的对话内容。

### US-3: 返回当前会话
**作为** 用户，  
**我希望** 能够轻松返回到当前活跃的会话，  
**以便** 继续最新的对话。

## 功能范围

### 包含
- "会话列表"菜单项的点击交互
- 历史会话列表的展示（按时间倒序排列）
- 每个会话项显示：起始时间、结束时间（如已归档）、消息数量、最后一条消息预览
- 当前活跃会话的高亮标识
- 点击会话项后切换 `ChatArea` 显示的消息内容，**抽屉自动关闭**
- 空状态提示（无历史会话时）
- Loading 状态和网络错误处理

### 不包含（后续迭代）
- 会话的删除或编辑功能
- 会话的重命名功能
- 会话的导出功能

## 验收标准

- [ ] AC-1: 点击"会话列表"菜单项后，抽屉内容区切换为会话列表视图，顶部显示返回按钮
- [ ] AC-2: 数据加载中显示 Loading 状态，加载失败显示错误提示和重试按钮
- [ ] AC-3: 会话列表按时间倒序排列，最新会话在最上方
- [ ] AC-4: 每个会话项显示起始时间、结束时间（归档会话）、消息数量、最后一条消息预览文本
- [ ] AC-5: 当前活跃会话有明显的视觉标识（如背景色或"进行中"标签）
- [ ] AC-6: 点击某个会话项后，`ChatArea` 加载并显示该会话的所有消息，**抽屉自动关闭**
- [ ] AC-7: 切换到归档会话后，用户可查看历史消息但为只读模式（底部输入框禁用并提示"已归档会话"）
- [ ] AC-8: 如果当前好友没有任何历史会话，显示友好的空状态提示
- [ ] AC-9: 支持滚动查看大量历史会话（如超过 10 个）

## 依赖关系

### 前置依赖
- Story 03-01: 基础抽屉组件和菜单框架
- Epic-01: 核心聊天功能（会话和消息 API）

### 被依赖（后续）
- 无直接被依赖

## 备注
- 后端 `/api/sessions` 接口需要支持按 `friend_id` 过滤查询，返回会话列表时包含最后一条消息预览
- 会话时间范围可以从会话的首条和末条消息时间戳推断
- 考虑对长时间运行的会话进行时间范围格式化（如"2026-01-01 ~ 2026-01-05"）
- 归档会话的只读模式仅影响消息输入，用户依然可以切回当前活跃会话继续对话
