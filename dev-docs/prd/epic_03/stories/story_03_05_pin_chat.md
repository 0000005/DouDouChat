# Story 03-05: 顶置聊天功能

> Epic: 聊天详情抽屉菜单  
> Priority: Medium  
> Points: 3

## 概述
在抽屉菜单中通过"置顶聊天" Toggle 开关切换当前好友在侧边栏会话列表中的顶置状态。顶置的好友会固定显示在列表最上方,并有明显的视觉标识。这让用户能够快速访问最重要或最常互动的 AI 好友。

## 用户故事

### US-1: 顶置重要好友
**作为** 用户，  
**我希望** 能够将重要的 AI 好友设置为顶置，  
**以便** 在侧边栏中快速找到并访问他们。

### US-2: 取消顶置
**作为** 用户，  
**我希望** 能够取消已顶置好友的顶置状态，  
**以便** 让侧边栏恢复正常排序。

### US-3: 识别顶置状态
**作为** 用户，  
**我希望** 能够清楚地看到哪些好友是顶置的，  
**以便** 快速区分重要联系人。

## 功能范围

### 包含
- "置顶聊天"菜单项的 **Toggle 开关**（参考微信设计）
- 开关实时反映当前顶置状态（开启 = 已顶置，关闭 = 未顶置）
- 切换 Toggle 开关时立即更新顶置状态（已顶置 ↔ 未顶置）
- 顶置状态的持久化存储（后端数据库）
- 侧边栏会话列表的排序逻辑更新（顶置好友在最上方）
- 顶置好友在侧边栏的视觉标识（图标或背景色）

### 不包含（后续迭代）
- 顶置好友的数量限制
- 顶置好友的自定义排序
- 批量顶置/取消顶置

## 验收标准

- [ ] AC-1: "置顶聊天"菜单项使用 Toggle 开关样式（参考微信）
- [ ] AC-2: Toggle 开关实时反映当前顶置状态（开启 = 已顶置，关闭 = 未顶置）
- [ ] AC-3: 切换 Toggle 开关后，立即更新顶置状态并显示 Toast 提示（"已置顶"或"已取消置顶"）
- [ ] AC-4: 顶置状态切换后，侧边栏会话列表立即重新排序，顶置好友显示在最上方
- [ ] AC-5: 顶置好友在侧边栏有明显的视觉标识（如图标）
- [ ] AC-6: 顶置状态在刷新页面后依然保持
- [ ] AC-7: 如果有多个顶置好友,它们之间按最近消息时间排序

## 依赖关系

### 前置依赖
- Story 03-01: 基础抽屉组件和菜单框架
- Epic-01: 核心聊天功能（好友数据模型）

### 被依赖（后续）
- 无直接被依赖

## 备注
- 后端需要在 `Friend` 模型中添加 `is_pinned` 字段（布尔类型）
- 前端使用 shadcn-vue 的 Switch 组件实现 Toggle 开关
- 前端 `Sidebar.vue` 的好友列表排序逻辑需要调整：顶置好友在前，其他好友按最近消息时间排序
- 顶置状态变更需要调用后端 API（如 `PATCH /api/friends/{friend_id}` 更新 `is_pinned` 字段）
