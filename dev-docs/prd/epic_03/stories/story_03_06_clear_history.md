# Story 03-06: 清空聊天记录功能

> Epic: 聊天详情抽屉菜单  
> Priority: Medium  
> Points: 3

## 概述
在抽屉菜单中点击"清空聊天记录"后，弹出确认对话框。用户确认后，删除与当前好友的所有历史消息和会话，但保留好友本身和 Memobase 生成的事件记忆。这让用户能够重新开始与 AI 好友的对话，同时 AI 仍保留对用户的长期记忆。

## 用户故事

### US-1: 清空聊天记录
**作为** 用户，  
**我希望** 能够清空与某个 AI 好友的所有聊天记录，  
**以便** 重新开始对话或清理历史数据。

### US-2: 确认危险操作
**作为** 用户，  
**我希望** 在执行清空操作前看到明确的确认提示，  
**以便** 避免误操作导致数据丢失。

### US-3: 保留记忆
**作为** 用户，  
**我希望** 清空聊天记录后，AI 对我的记忆（事件记忆）仍然保留，  
**以便** AI 不会完全"遗忘"我的信息。

## 功能范围

### 包含
- "清空聊天记录"菜单项的点击交互
- 确认对话框（警告用户此操作不可逆）
- 用户确认后删除所有消息和会话（保留好友和记忆）
- 清空后 `ChatArea` 显示空状态提示
- 操作成功的反馈提示

### 不包含（后续迭代）
- 清空单个会话（而非全部）
- 清空消息同时清空记忆的选项
- 数据恢复功能

## 验收标准

- [ ] AC-1: "清空聊天记录"菜单项使用**红色文字**（危险操作标识，参考微信）
- [ ] AC-2: 点击"清空聊天记录"菜单项后，弹出确认对话框
- [ ] AC-3: 确认对话框明确提示"此操作将删除所有聊天记录，但保留 AI 对您的记忆，是否继续？"
- [ ] AC-4: 确认对话框包含"取消"和"确认"按钮，其中"确认"按钮使用红色警示样式
- [ ] AC-5: 用户点击"取消"后，对话框关闭，不执行任何操作
- [ ] AC-6: 用户点击"确认"后，显示 Loading 状态，删除与当前好友的所有消息和会话记录
- [ ] AC-7: 清空操作完成后，抽屉自动关闭，`ChatArea` 显示"暂无聊天记录"等空状态提示
- [ ] AC-8: 抽屉菜单中的"会话列表"显示为空
- [ ] AC-9: "记忆列表"中的事件记忆不受影响，依然可见
- [ ] AC-10: 清空操作成功后显示 Toast 提示"聊天记录已清空"
- [ ] AC-11: 清空操作失败时显示错误提示

## 依赖关系

### 前置依赖
- Story 03-01: 基础抽屉组件和菜单框架
- Epic-01: 核心聊天功能（消息和会话 API）

### 被依赖（后续）
- 无直接被依赖

## 备注
- 后端需要提供 `DELETE /api/friends/{friend_id}/messages` 接口，删除指定好友的所有消息和会话
- 前端需要在清空后刷新 `ChatArea` 和会话列表状态
- 确认对话框可以使用 shadcn-vue 的 Alert Dialog 组件
